<%= render 'layouts/biz/dash' %>

<div class="contentWrapper">
  <div class="content">

    <!--Flash messages-->
    <% flash.each do |key, value| %>
        <div class="alert alert-<%= key %>"><%= value %></div>
    <% end %>

    <!-- Content Heading -->
    <div class="pull-left">
      <p class="b2 content-title">Gifts</p>
    </div>

    <div class="clearfix"></div>
    <div class="content-separator"></div>

    <!-- Content Body -->
    <h4 class="panel-title">
      Total Burps: <%= @merchant.total_points%>
    </h4>

    <div class="panel-body">
      <table class="table table-bordered table-hover table-responsive">
        <tr>
          <th>Gift Name</th>
          <th>Points Required</th>
          <th>Description</th>
          <th></th>
        </tr>

        <% @gifts.where(gift_type: "Merchant").find_each do |p| %>
            <tr>
              <td><%= p.name %></td>
              <td><%= p.points %></td>
              <td><%= p.description %></td>
              <td>
                <% if GiftService.check_redeemable(@merchant_id, p) %>
                    <%= link_to gift_path(p) do%>
                        <button class="btn btn-success">
                          Redeem
                        </button>
                    <% end %>
                <% else %>
                    <button class="btn btn-default disabled" type="button" data-toggle="tooltip" data-placement="top" title="Sorry, you have insufficient points to redeem this gift.">
                      Redeem
                    </button>
                <% end %>
              </td>
            </tr>
        <% end %>
      </table>
    </div>

  </div><!-- /content -->
</div><!-- /contentWrapper -->

<%= content_for :lean_overlay do %>
<% end %>

<%= content_for :body_footer do %>
<% end %>


